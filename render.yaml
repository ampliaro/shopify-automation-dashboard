services:
  # Backend + Frontend em um único serviço (Web Service)
  - type: web
    name: shopify-automation-dashboard
    env: node
    region: oregon
    plan: free
    buildCommand: |
      cd frontend && npm install && npm run build && cd ../backend && npm install && npm run seed
    startCommand: |
      cd backend && NODE_ENV=production node src/server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: DATABASE_URL
        value: ./data/app.db
      - key: ENABLE_MOCK
        value: true
      - key: FULFILLMENT_URL
        value: http://localhost:10000/mock/fulfillment
      - key: SHOPIFY_SHARED_SECRET
        generateValue: true
      - key: ADMIN_TOKEN
        generateValue: true
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: TELEGRAM_ADMIN_CHAT_IDS
        sync: false
    healthCheckPath: /healthz
    autoDeploy: true

